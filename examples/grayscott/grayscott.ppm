client grayscott
  integer, dimension(4) :: bcd = ppm_param_bcdef_periodic
  integer, dimension(2) :: seed
  real(ppm_kind_double), dimension(:,:), pointer :: displace

  ppm_init()

  topo = create_topology(bcd)

  c = create_particles(topo)

  allocate(displace(2,c%Npart))
  call random_number(displace)
  displace = (displace - 0.5_mk) * c%h_avg * 0.15_mk
  call c%move(displace, info)
  call c%apply_bc(info)
  call c%set_cutoff(4._mk * c%h_avg, info)

  global_mapping(c, topo)
  
  U = create_field(1, "U")
  V = create_field(1, "V")

  discretize(U,c)
  discretize(V,c)

  ghost_mapping(c)

  foreach p in particles(c) with positions(x) sca_fields(V)
    V_p = 1
  end foreach

  create_neighlist(c)

  Lap = define_op(2, [2, 0, 0, 2], [1.0_mk, 1.0_mk], "Laplacian")
  L = compute_op(Lap, c, "DC-PSE")

  o, nstages = create_ode([U=>c,V=>c], grahscott_rhs, [U,V], eulerf)

  t = timeloop(0.0_mk,deltat=dt)
    ghost_mapping(c)
    do istage=1,nstages
      ode_step(o, t, dt, istage)
      write(*,*) "time: ", t
    end do
  end timeloop

  ppm_finalize()
end client
